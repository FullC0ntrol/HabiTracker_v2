# ğŸ‹ï¸ HabitTracker â€” Schemat bazy danych i API

Backend aplikacji do Å›ledzenia treningÃ³w i nawykÃ³w.  
Technologie: **Node.js (Express)**, **SQLite (better-sqlite3)**, **JWT Auth**.

---

## ğŸ—„ï¸ Schemat bazy danych

### **users**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator uÅ¼ytkownika |
| `username` | TEXT UNIQUE | Nazwa uÅ¼ytkownika |
| `pin_hash` | TEXT | Hash 4-cyfrowego PINu |
| `created_at` | TEXT | Data utworzenia (ISO datetime) |

---

### **exercises**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator Ä‡wiczenia |
| `name` | TEXT | Nazwa Ä‡wiczenia |
| `muscle_group` | TEXT | Grupa miÄ™Å›niowa (np. Chest, Legsâ€¦) |

---

### **plans**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator planu |
| `user_id` | INTEGER FK â†’ users.id | WÅ‚aÅ›ciciel planu |
| `name` | TEXT | Nazwa planu |
| `created_at` | TEXT | Data utworzenia |

---

### **plan_exercises**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator wpisu |
| `plan_id` | INTEGER FK â†’ plans.id | PowiÄ…zany plan |
| `exercise_id` | INTEGER FK â†’ exercises.id | PowiÄ…zane Ä‡wiczenie |
| `order_index` | INTEGER | KolejnoÅ›Ä‡ w planie |
| `sets` | INTEGER | Liczba serii |
| `reps` | TEXT | Liczba powtÃ³rzeÅ„ (np. "8-12") |

---

### **workout_sessions**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator sesji |
| `user_id` | INTEGER FK â†’ users.id | UÅ¼ytkownik |
| `date` | TEXT | Data (YYYY-MM-DD) |
| `created_at` | TEXT | Data utworzenia |
| UNIQUE(`user_id`, `date`) | | Jedna sesja na dzieÅ„ |

---

### **workout_session_exercises**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator wpisu |
| `session_id` | INTEGER FK â†’ workout_sessions.id | Sesja treningowa |
| `exercise_id` | INTEGER FK â†’ exercises.id | Ä†wiczenie |
| `sets` | INTEGER | Serii |
| `reps` | TEXT | PowtÃ³rzeÅ„ |
| `weight` | REAL | CiÄ™Å¼ar (opcjonalnie) |

---

### **habits**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator nawyku |
| `user_id` | INTEGER FK â†’ users.id | UÅ¼ytkownik |
| `name` | TEXT | Nazwa nawyku |
| `target` | INTEGER | Cel dzienny |
| `unit` | TEXT | Jednostka (np. â€countâ€) |
| `created_at` | TEXT | Data utworzenia |

---

### **habit_entries**
| Kolumna | Typ | Opis |
|----------|-----|------|
| `id` | INTEGER PK | Identyfikator wpisu |
| `habit_id` | INTEGER FK â†’ habits.id | PowiÄ…zany nawyk |
| `date` | TEXT | Data (YYYY-MM-DD) |
| `value` | INTEGER | WartoÅ›Ä‡ (np. 0/1) |
| UNIQUE(`habit_id`, `date`) | | Jeden wpis na dzieÅ„/nawyk |

---

## ğŸŒ API â€” SkrÃ³t endpointÃ³w

### ğŸ”‘ Autoryzacja
| Metoda | Endpoint | Body | Opis |
|--------|-----------|------|------|
| **POST** | `/api/auth` | `{ "username": "adam", "pin": "1234" }` | Logowanie lub rejestracja, zwraca token JWT |

---

### ğŸ‘¤ UÅ¼ytkownik
| Metoda | Endpoint | Body | Opis |
|--------|-----------|------|------|
| **GET** | `/api/me` | â€” | Zwraca dane aktualnego uÅ¼ytkownika (`{ username }`) |

---

### ğŸ‹ï¸ Ä†wiczenia
| Metoda | Endpoint | Body | Opis |
|--------|-----------|------|------|
| **GET** | `/api/exercises` | â€” | Pobiera listÄ™ wszystkich Ä‡wiczeÅ„ |
| **POST** | `/api/exercises` | `{ name, category }` | Dodaje nowe Ä‡wiczenie |
| **PATCH** | `/api/exercises/:id` | `{ name?, category? }` | Edytuje istniejÄ…ce Ä‡wiczenie |
| **DELETE** | `/api/exercises/:id` | â€” | Usuwa Ä‡wiczenie (409 jeÅ›li jest w planie lub sesji, `?force=true` Å¼eby wymusiÄ‡) |

---

### ğŸ§© Plany
| Metoda | Endpoint | Body | Opis |
|--------|-----------|------|------|
| **GET** | `/api/plans` | â€” | Lista planÃ³w uÅ¼ytkownika |
| **GET** | `/api/plans/:id` | â€” | SzczegÃ³Å‚y planu (Ä‡wiczenia) |
| **POST** | `/api/plans` | `{ name, items:[{exercise_id, sets, reps}] }` | Tworzy plan |
| **DELETE** | `/api/plans/:id` | â€” | Usuwa plan |

---

### ğŸ—“ï¸ Treningi
| Metoda | Endpoint | Body / Query | Opis |
|--------|-----------|--------------|------|
| **GET** | `/api/workouts/days` | `?from=YYYY-MM-DD&to=YYYY-MM-DD` | Zwraca daty dni, w ktÃ³rych byÅ‚ trening |
| **POST** | `/api/workouts/sessions` | `{ date: "YYYY-MM-DD" }` | Oznacza dzieÅ„ jako â€trening wykonanyâ€ |
| **DELETE** | `/api/workouts/sessions?date=YYYY-MM-DD` | â€” | Usuwa oznaczenie treningu dla dnia |

---

### ğŸŒ± Nawyki
| Metoda | Endpoint | Body / Query | Opis |
|--------|-----------|--------------|------|
| **GET** | `/api/habits` | â€” | Lista wszystkich nawykÃ³w uÅ¼ytkownika |
| **POST** | `/api/habits` | `{ name, target?, unit? }` | Dodaje nowy nawyk |
| **GET** | `/api/habits/entries` | `?from=YYYY-MM-DD&to=YYYY-MM-DD` | Pobiera wpisy nawykÃ³w z zakresu dat |
| **POST** | `/api/habits/:id/entries` | `{ date, value }` | Ustawia wartoÅ›Ä‡ nawyku dla dnia |

---

### ğŸ”’ NagÅ‚Ã³wki autoryzacji
WiÄ™kszoÅ›Ä‡ endpointÃ³w wymaga tokenu JWT:

